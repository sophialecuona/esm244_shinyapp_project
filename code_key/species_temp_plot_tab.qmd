---
title: "Plot Species/Temperature Tab"
format: html
editor: visual
---

## Libraries

```{r}
library(tidyverse)
library(here)
library(broom)
library(janitor)
library(cowplot)
library(dplyr)
```

## Input Data

Take from Data Wrangling Tab

```{r}
eis <- all %>%
  select(year, comm_name, value_usd, landings_mt, landings_kg, landings_lb, price_usd_lb) %>%
  filter(comm_name %in% c("Chinook salmon", "Dungeness crab", "Market squid"))
```

## Depth Related Plots

```{r}

#Depth vs Year - all species
ggplot(full_dung_squid_chin, aes(x = year, y = depth, color = species)) +
   geom_point() +
  geom_smooth(method = "glm", se = FALSE) + 
  labs(title = "Depth vs. Year",
       x = "Year",
       y = "Depth (m)",
       color = "Species Type") +
  scale_color_manual(values = c("#74E291", "#59B4C3", "#211C6A")) +
  theme_minimal() +
  theme(legend.title = element_text(face = "bold", size = 12))

#Depth vs Year - crab and squid

ggplot(full_dung_squid, aes(x = year, y = depth, color = species)) +
  geom_jitter(width = 0.2, height = 0, alpha = 0.5, size = 1) +  # Add jitter for better visibility
  geom_smooth(method = "loess", se = FALSE, color = "black") +  # Add non-linear smoother
  labs(title = "Depth vs. Year",
       x = "Year",
       y = "Depth (m)",
       color = "Species Type") +
  scale_color_manual(values = c("#59B4C3", "#E193BC")) +
  theme_minimal() +
  theme(legend.title = element_text(face = "bold", size = 12))

#CRAB ONLY
crab_dismap <- full_dung_squid %>%
  filter(species == "dungeness")

ggplot(crab_dismap, aes(x = year, y = depth, color = species)) +
  geom_point()+
  geom_jitter(width = 0.2, height = 0, alpha = 0.5, size = 1) +
  labs(title = "Depth vs. Year",
       x = "Year",
       y = "Depth (m)",
       color = "Species Type") +
  scale_color_manual(values = c("#59B4C3")) +
  theme_minimal() 

#SQUID ONLY
squid_dismap <- full_dung_squid %>%
  filter(species == "squid")

ggplot(squid_dismap, aes(x = year, y = depth, color = species)) +
  geom_point()+
  geom_jitter(width = 0.2, height = 0, alpha = 0.5, size = 1) +
  labs(title = "Depth vs. Year",
       x = "Year",
       y = "Depth (m)",
       color = "Species Type") +
  scale_color_manual(values = c("#211C6A")) +
  theme_minimal() 

#CHINOOK
chinook_dismap <- full_dung_squid_chin %>%
  filter(species == "chinook")

ggplot(squid_dismap, aes(x = year, y = depth, color = species)) +
  geom_point()+
  geom_jitter(width = 0.2, height = 0, alpha = 0.5, size = 1) +
  labs(title = "Depth vs. Year",
       x = "Year",
       y = "Depth (m)",
       color = "Species Type") +
  scale_color_manual(values = c("#74E291")) +
  theme_minimal() 



############### DEPTH VS CPUE

#Depth vs CPUE
ggplot(full_dung_squid_chin, aes(x = wtcpue, y = depth, color = species)) +
   geom_violin() +
  labs(title = "CPUE vs. Year",
       x = "CPUE",
       y = "Depth (m)",
       color = "Species Type") +
  scale_color_manual(values = c("#74E291", "#59B4C3", "#211C6A")) +
  theme_minimal() +
  theme(legend.title = element_text(face = "bold", size = 12))

#Depth vs CPUE - just crab and squid
ggplot(full_dung_squid, aes(x = wtcpue, y = depth, fill = species)) +
   geom_violin() +
  labs(title = "CPUE vs. Year",
       x = "CPUE",
       y = "Depth (m)",
       fill = "Species Type") +
  scale_fill_manual(values = c("#59B4C3", "#211C6A")) +
  theme_minimal() +
  theme(legend.title = element_text(face = "bold", size = 12))

```

## CPUE Related Plots

```{r}
#full_dung_dquid_chin dataset

ggplot(full_dung_squid_chin, aes(x = year, y = wtcpue, color = species)) +
  geom_point() +
  geom_smooth(method = "glm", se = FALSE) + 
  labs(title = "CPUE vs. Species",
       x = "Year",
       y = "Weighted Catch Per Unit Effort (CPUE)",
       color = "Species Type") +
  scale_color_manual(values = c("#74E291", "#59B4C3", "#211C6A")) +
  theme_minimal() +
  theme(legend.title = element_text(face = "bold", size = 12))

#Count chart
ggplot(full_dung_squid_chin, aes(x = year, y = wtcpue, color = species)) +
  geom_count(show.legend = FALSE) +
  labs(title = "CPUE vs. Species",
       x = "Year",
       y = "Weighted Catch Per Unit Effort (CPUE)",
       color = "Species Type")+
  scale_color_manual(values = c("#74E291", "#59B4C3", "#211C6A"))+
   theme_minimal()


#Has a lot of outliers for Dunges may need to remove - no model of best fit is working

```

## Bubble Chart Experimentation

```{r}
#Bubble chart   ###### could add with other dataset to look at landings
ggplot(full_dung_squid_chin, aes(x = year, y = wtcpue, color = species, size = depth)) +
  geom_point(alpha = 0.6)+
  scale_size(range = c(.1, 10), name="Depth (m)")+
  labs(title = "CPUE vs. Species vs. Depth",
       x = "Year",
       y = "Weighted Catch Per Unit Effort (CPUE)",
       color = "Species Type")+
  scale_color_manual(values = c("#74E291", "#59B4C3", "#211C6A"))+
   theme_minimal()


```

## Landings vs Species

```{r}
ggplot(eis, aes(x = year, y = landings_lb, color = comm_name)+
  geom_point()#size = price_usd_lb
#squid all alone and doing weird things

ggplot(eis, aes(x = year, y = landings_kg, color = comm_name)) +
  geom_point(alpha = 0.6)
#tried all different landings options and scatter plot still looks the same
#seperate crab and chinook from squid

#### Squid Only
squid_eis <- eis %>%
  filter(comm_name == "Market squid")

ggplot(squid_eis, aes(x = year, y = landings_lb, color = comm_name)) +
  geom_point(alpha = 0.75)+
  geom_smooth(method = "glm") + 
  labs(title = "Year vs. Landings of Market Squid",
       x = "Year",
       y = "Landings (lbs)",
       color = "Species Type") +
  scale_color_manual(values = c("#211C6A")) +
  theme_minimal() +
  theme(legend.title = element_text(face = "bold", size = 12))


#### Chinook and Crab
crab_chin_eis <- eis |>
  filter(comm_name == c("Chinook salmon", "Dungeness crab")

ggplot(crab_chin_eis, aes(x = year, y = landings_lb, color = comm_name)) +
  geom_point(alpha = 0.75)+
  geom_smooth(method = "glm", se = FALSE) + 
  labs(title = "Year vs. Landings of Chinook salmon and Dungeness crab",
       x = "Year",
       y = "Landings (lbs)",
       color = "Species Type") +
  scale_color_manual(values = c("#74E291", "#59B4C3")) +
  theme_minimal() +
  theme(legend.title = element_text(face = "bold", size = 12))
```

## Value vs Species

```{r}
ggplot(eis, aes(x = year, y = value_usd, color = comm_name)) +
  geom_point(alpha = 0.75)+
  geom_smooth(method = "glm", se = FALSE) + 
  labs(title = "Year vs. Value of all fisheries",
       x = "Year",
       y = "Value USD",
       color = "Species Type") +
  scale_color_manual(values = c("#74E291", "#59B4C3", "#211C6A")) +
  theme_minimal() +
  theme(legend.title = element_text(face = "bold", size = 12))

#Experiment with size aS landings
ggplot(eis, aes(x = year, y = value_usd, color = comm_name, size = landings_lb)) +
  geom_point(alpha = 0.75)+
  geom_smooth(method = "glm", se = FALSE) + 
  labs(title = "Year vs. Value of all fisheries",
       x = "Year",
       y = "Value USD",
       color = "Species Type",
       size = "Landings (lbs)") +
  scale_color_manual(values = c("#74E291", "#59B4C3", "#211C6A")) +
  theme(legend.title = element_text(face = "bold", size = 12),
        legend.background = element_rect(fill = "transparent"))


#Experiment with size aS price_usd_lb
ggplot(eis, aes(x = year, y = value_usd, color = comm_name, size = price_usd_lb)) +
  geom_point(alpha = 0.75)+
  geom_smooth(method = "glm", se = FALSE) + 
  labs(title = "Year vs. Value of all fisheries",
       x = "Year",
       y = "Value USD",
       color = "Species Type",
       size = "Price (USD)") +
  scale_color_manual(values = c("#74E291", "#59B4C3", "#211C6A")) +
  theme(legend.title = element_text(face = "bold", size = 12))
```

## Joining EIS and DisMap Data

```{r}
eis_dismap <- full_join(
  eis,
  full_dung_squid_chin, 
  by = NULL,
  suffix = c(".x", ".y"),
  keep = FALSE
)

#might need to account for comm_name and species calling the species names slightly different things 

#### GOAL IS TO GET WTCPUE VS LANDINGS CAPTURED
```

## Mapping the joined data sets

```{r}
#STILL WORKING ON THE JOINING COMPONENT FIRST
```

## Temperature Related Plots (do not have yet)

```{r}

```

## LONG TERM GOAL: Temp vs Time with catch mapped overtop

```{r}

```
