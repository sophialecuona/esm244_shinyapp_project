---
title: "Linear Regression Tab"
format: html
editor: visual
---

```{r}
library(here)
library(tidyverse)
library(janitor)
library(dplyr)
```

```{r}
squid_rev <- eis %>% 
  filter(comm_name == "Market squid")

  
squid_output<-lm(value_usd ~ year, data=squid_rev) #linear model (lm) 
squid_output # gets only the coefficients
summary(squid_output)  

broom::tidy(squid_output) %>% 
  knitr::kable() %>% 
  kableExtra::kable_classic_2()
```

```{r}
squid_plot<-ggplot(squid_rev, aes(x= year, y= value_usd))+
  geom_point()+
  labs(x=" ", y="Revenue in Millions (USD)")+
  geom_abline(intercept = coef(squid_output)[1], 
              slope = coef(squid_output)[2])+
  theme_bw()+
  scale_y_continuous(labels = scales::label_number(scale = 1e-6))



squid_plot
```

```{r}
chinook_rev <- eis %>% 
  filter(comm_name == "Chinook salmon")

chinook_output<-lm(value_usd ~ year, data=chinook_rev) #linear model (lm) 
chinook_output # gets only the coefficients
summary(chinook_output)

broom::tidy(chinook_output) %>% 
  knitr::kable() %>% 
  kableExtra::kable_classic_2()
```

```{r}
chinook_plot<-ggplot(chinook_rev, aes(x= year, y= value_usd))+
  geom_point()+
  labs(x=" ", y="Revenue in Millions (USD)")+
  geom_abline(intercept = coef(chinook_output)[1], 
              slope = coef(chinook_output)[2])+
  theme_bw()+
  scale_y_continuous(labels = scales::label_number(scale = 1e-6))

chinook_plot
```

```{r}
dung_rev <- eis %>% 
  filter(comm_name == "Dungeness crab")

dung_output<-lm(value_usd ~ year, data=dung_rev) #linear model (lm) 
dung_output # gets only the coefficients
summary(dung_output)

broom::tidy(dung_output) %>% 
  knitr::kable() %>% 
  kableExtra::kable_classic_2()
```

```{r}
dung_plot<-ggplot(dung_rev, aes(x= year, y= value_usd))+
  geom_point()+
  labs(x=" ", y="Revenue in Millions (USD)")+
  geom_abline(intercept = coef(dung_output)[1], 
              slope = coef(dung_output)[2])+
  theme_bw()+
  scale_y_continuous(labels = scales::label_number(scale = 1e-6))

dung_plot
```
